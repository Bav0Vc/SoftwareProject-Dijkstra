<details style="border-radius: 5px; display: inline-block; max-width: 100%; width: 100%;">
    <summary style="cursor: pointer; font-size: 16px; display: inline-block; padding: 10px 15px; background-color: #ccc; border-radius: 5px;">Toggle Code</summary>
    <div style="background-color: #f0f0f0; border-radius: 5px; margin-top: 5px; padding: 10px; max-width: 100%; max-height: 50vh; width: fit-content; overflow: auto;">
<div class="highlight" style="background: #f0f0f0"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre style="line-height: 125%;">
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">49</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">50</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">51</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">52</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">53</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">54</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">55</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">56</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">57</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">58</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">59</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">60</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">61</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">62</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><span style="color: #007020; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">math</span>
inf <span style="color: #666666">=</span> math<span style="color: #666666">.</span>inf
x <span style="color: #666666">=</span> <span style="color: #666666">-</span>inf  <span style="color: #60a0b0; font-style: italic"># no path from ... to ... in adjacency matrix</span>

<span style="color: #60a0b0; font-style: italic"># predecessor of discovered node</span>
pred <span style="color: #666666">=</span> []
<span style="color: #60a0b0; font-style: italic"># costs to starting node s</span>
cost <span style="color: #666666">=</span> []
<span style="color: #60a0b0; font-style: italic"># set of finished nodes</span>
f <span style="color: #666666">=</span> []
<span style="color: #60a0b0; font-style: italic"># length of the graph</span>
n <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">None</span>
<span style="color: #60a0b0; font-style: italic"># graph</span>
g <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">None</span>

pq <span style="color: #666666">=</span> []


<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">extract_min</span>(pq):
  min_index <span style="color: #666666">=</span> <span style="color: #40a070">0</span>
  <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #40a070">1</span>, <span style="color: #007020">len</span>(pq)):
    <span style="color: #007020; font-weight: bold">if</span> cost[pq[i]] <span style="color: #666666">&lt;</span> cost[pq[min_index]]:
      min_index <span style="color: #666666">=</span> i
  min_index <span style="color: #666666">=</span> pq<span style="color: #666666">.</span>pop(min_index)
  <span style="color: #007020; font-weight: bold">return</span> min_index


<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">initialization</span>(s, graph):
  <span style="color: #007020; font-weight: bold">global</span> pred, cost, f, pq, n, g
  g <span style="color: #666666">=</span> graph
  n <span style="color: #666666">=</span> <span style="color: #007020">len</span>(g)
  pred <span style="color: #666666">=</span> [<span style="color: #666666">-</span><span style="color: #40a070">1</span>]<span style="color: #666666">*</span>n
  cost <span style="color: #666666">=</span> [inf]<span style="color: #666666">*</span>n
  cost[s] <span style="color: #666666">=</span> <span style="color: #40a070">0</span>
  f <span style="color: #666666">=</span> []
  pq <span style="color: #666666">=</span> [i <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(n)]


<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">relax</span>(u, v):
  <span style="color: #007020; font-weight: bold">if</span> cost[v] <span style="color: #666666">&gt;</span> cost[u] <span style="color: #666666">+</span> g[u][v]:
    cost[v] <span style="color: #666666">=</span> cost[u] <span style="color: #666666">+</span> g[u][v]
    pred[v] <span style="color: #666666">=</span> u


<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">dijkstra</span>():
  <span style="color: #007020; font-weight: bold">while</span> <span style="color: #007020">len</span>(pq) <span style="color: #666666">&gt;</span> <span style="color: #40a070">0</span>:
    u <span style="color: #666666">=</span> extract_min(pq)
    f<span style="color: #666666">.</span>append(u)
    <span style="color: #007020; font-weight: bold">for</span> v <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(n):
      <span style="color: #007020; font-weight: bold">if</span> g[u][v] <span style="color: #666666">&gt;</span> <span style="color: #40a070">0</span>:
        relax(u, v)


<span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">get_path</span>(u, v):
  <span style="color: #007020; font-weight: bold">if</span> pred[v] <span style="color: #666666">==</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>:
    <span style="color: #007020; font-weight: bold">return</span> []
  <span style="color: #60a0b0; font-style: italic"># start from last node</span>
  path <span style="color: #666666">=</span> [v]
  <span style="color: #007020; font-weight: bold">while</span> u <span style="color: #666666">!=</span> v:
    v <span style="color: #666666">=</span> pred[v]
    path<span style="color: #666666">.</span>insert(<span style="color: #40a070">0</span>, v)
  <span style="color: #007020; font-weight: bold">return</span> path
</pre></div></td></tr></table></div>
    </div>
</details>